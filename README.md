! ГАЙД В ПРОЦЕССЕ НАПИСАНИЯ

# Установка своего VPN-сервера WireGuard на VPS-хостинг с Ubuntu

[WireGuard](https://www.wireguard.com/) – самый актуальный и быстрый VPN-протокол. Обеспечивает максимальную скорость работы и надежную криптографическую защиту.

## 1. Хостинг и клиенты

VPS-хостинг желательно выбирать в [Европе](https://ru.hostings.info/filters/europe-hosting/vps-vds
), но сейчас оплатить его уже будет проблематично. Можно выбрать [российский хостинг](https://ru.hostings.info/filters/russia/vps-vds) с серверами в Европе. У меня хостинг от [FirstByte](https://firstbyte.ru/?from=87020) с сервером в Нидерландах за 111₽ в месяц. Если будете брать там, то буду признателен, если перейдете по моей ссылке или воспользуетесь моим промокодом *refer_87020*.

Важно выбрать сервер с [KVM-виртуализацией](https://firstbyte.ru/vps-vds/kvm-ssd-eu/?from=87020), так как WireGuard Manager нельзя установить на сервер с OpenVZ-виртуализацией. На этапе выбора ОС для сервера, выберите Ubuntu 18.04, однако скрипт [WireGuard Manager](https://github.com/complexorganizations/wireguard-manager) может развернуть и на других [дистрибутивах Linux](https://github.com/complexorganizations/wireguard-manager#-compatibility-with-linux-distro).

На поднятие сервера нужно время, после чего приходит письмо из которого нам нужно три пункта: IP-адрес сервера, имя пользователя (root), пароль.

Заранее поставьте все необходимые [клиенты WireGuard](https://www.wireguard.com/install/).

## 2. Подключение к серверу

Если у вас российский хостинг, то взаимодействие с виртуальной машиной обычно происходит через запуск VNC-клиента в панели управления сервером, но я на винде предпочитаю использовать программу [PuTTY](https://www.putty.org/), в которой удобно вставлять текст из буфера обмена правой кнопкой мыши. Запускаем VNC-клиент или вводим в PuTTY IP-адрес сервера, после подключения вводим логин (root) и пароль от сервера.

После подключения к сервером проверьте ОС на наличие обновлений, выполнив следующую команду:

```
apt-get update && apt-get upgrade
```

## 3. Установка WireGuard Manager

1. Сначала установим инструмент curl:

```
apt install curl -y
```

2. Затем запустим скачивание скрипта установки:

```
curl https://raw.githubusercontent.com/complexorganizations/wireguard-manager/main/wireguard-manager.sh --create-dirs -o /usr/local/bin/wireguard-manager.sh
```

3. Делаем скрипт исполняемым:

```
chmod +x /usr/local/bin/wireguard-manager.sh
```

4. Запускаем установку:

```
bash /usr/local/bin/wireguard-manager.sh
```

Установка разделена на этапы, выбирайте везде Recommended, но остановитесь на следующих этапах:

- «**Would you like to install unbound**», выберите «**Custom (Advanced)**».
- «**Let the users choose their custom dns provider**», выберите «**Cloudflare (Recommended)**».
- «**What would you like to name your first WireGuard peer**», задаем название клиентскому файлу конфигурации в виде одного слова, например wireguard.

Настройка и затем установка WireGuard займет не больше 5 минут.

5. По окончанию установки будет отображен QR-код для подключения с мобильного клиента WireGuard. Выберите в приложении «**Сканировать QR-код**» и попробуйте подключиться.

На этом установка WireGuard для доступа к VPN с вашего мобильного устройства завершена.

## 4. Добавление новых устройств в WireGuard

Для каждого отдельного устройства нужно генерировать отдельный конфигурационный файл.

Например для клиента WireGuard для Windows нужно будет создать еще один конфигурационный файл. Для этого мы запускаем скрипт WireGuard Manager с помощью уже знакомой команды:

```
bash /usr/local/bin/wireguard-manager.sh
```

Выбираем 5-й пункт «**Add WireGuard Peer (client)**», удаляем длинную строку и пишем wireguard-windows. Появится QR-код, но нам теперь нужен не он, а путь к конфигурационному файлу под ним. Открываем содержимое файла следующей командой:

```
nano /etc/wireguard/clients/wireguard-windows-wg0.conf
```

Затем копируем весь текст в любой блокнот и сохраняем файл с именем wireguard-windows-wg0.conf

На винде можно установить программу [WinSCP](https://winscp.net/eng/download.php), подключиться по SFTP к серверу и получить доступ в виде двухпанельного проводника, потом можно найти этот файл и скопировать к себе на ПК.

## 5. Подключение к WireGuard VPN

Подключение с мобильных устройств самое простое. После сканирования QR-кода, создается соединение к вашему серверу и вам остается только к нему подключиться.

Для клиента под Windows, нажимаем в WireGuard «**Добавить туннель**» и выбираем созданный ранее конфигурационный файл wireguard-windows-wg0.conf и пробуем подключиться.

Заходим [сюда](https://whatismyipaddress.com/) и видим IP-адрес и страну вашего сервера.

Проверяем доступ к заблокированным сайтам и замеряем скорость на [Speedcheck](https://www.speedcheck.org/ru/).
